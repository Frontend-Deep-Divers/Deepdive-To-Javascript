# 11장 원시 값과 객체의 비교

원시 타입과 객체 타입은 근본적으로 다르다.

원시 타입과 객체 타입의 차이점은 크게 다음과 같다.

1. 원시 타입의 값은 **불변**하며, 객체 타입은 **변할 수 있다**.
2. 원시 값을 변수에 할당하면 변수(확보된 메모리 공간)에는 **실제 값이 저장**된다. 객체를 변수에 할당하면 변수(확보된 메모리 공간)에는 **참조 값이 저장**된다.
3. 원시 값을 갖는 변수를 다른 변수에 할당하면 **원본의 원시 값이 복사되어 전달(pass by value)된다.** 반면 객체를 가리키는 변수를 다른 변수에 할당하면 **원본의 참조 값이 복사되어 전달(pass by reference)된다.**

## 11.1 원시 값

원시 타입의 값은 불변하다. 즉, 읽기 전용 값이다.

⚠️값과 변수를 헷갈리면 안된다. 변수는 언제든지 '어느 값'으로나 변경할 수 있다. 재할당 불가능한 변수를 상수라고 한다.

변수 값을 변경하기 위해 원시 값을 재할당하면 새로운 메모리 공간을 확보하고 재할당한 값을 저장한 후, 변수가 참조하면 메모리 공간의 주소를 변경한다. 값의 이러한 특성을 **불변성(immutability)**이라 한다.

C나 자바와 다르게 자바스크립트의 문자열 타입은 불변하다.

문자열은 유사 배열 객체이며 이터러블이므로 배열과 유사하게 각 문자에 접근할 수 있다.

> 유사 배열 객체: 마치 배열처럼 인덱스로 프로퍼티 값에 접근할 수 있고, `length` 프로퍼티를 갖는 객체.
> for 문으로 순회할 수도 있다.

하지만, 문자열은 불변하기 때문에 일부 문자를 변경하거나 하는 일은 할 수 없다.

⚠️원시 값은 call by value임을 주의. (자바스크립트 엔진을 구현하는 제조사마다 실제 내부 동작이 다르기 때문에, 같은 값의 메모리 공간을 공유할 수도 있고, 그렇지 않을 수도 있다.)

```js
var score = 80;
var copy = score;

console.log(score, copy); // 80 80

var score = 100;
console.log(score, copy); // 100 80
```

## 11.2 객체

자바스크립트의 객체:

- 프로퍼티의 개수는 정해져 있지 않다.
- 동적 수정이 가능하다.
- 프로퍼티 값에 제약이 없으므로 확보할 메모리 공간 크기를 사전에 정할 수 없다.

복잡한 자료구조이기에 구현 방식이 브라우저 제조사마다 다를 수 있다. (아마 객체 구현에 있어 구체적인 표준이 없는 듯?)

---

### 💡자바스크립트의 객체 관리 방식

자바스크립트의 객체는 프로퍼티 키를 인덱스로 하는 해시 테이블이라고 생각할 수 있다. 하지만 대부분 구현에서는 성능을 위해 더 나은 방법으로 구현한다.

V8 엔진에서는 프로퍼티에 접근하기 위해 <b>히든 클래스(hidden class)</b>라는 방식을 사용해 C++ 정도의 성능을 보장한다. 자바와 같이 고정된 객체 레이아웃(즉, 클래스)와 유사하게 동작한다.

책에서는 히든 클래스에 대한 유용한 링크가 있으니 더 자세히 알아보려면 이를 참고할 것.

---

객체는 변경가능한 값이다.

객체를 할당한 변수가 기억 하는 메모리 공간에 접근하면 **참조 값**에 접근할 수 있다. 참조 값은 생성된 객체가 저장된 메모리 공간의 주소, 그 자체다.

객체의 생성, 관리는 매우 복잡하며 비용이 많이 든다. 때문에 변경할 때마다 새로 메모리를 확보한다면 메모리를 많이 잡아 먹을 것이다. 따라서, 객체는 변경 가능한 값으로 설계되었다.

이러한 구조적 특성 때문에, **여러 개의 식별자가 하나의 객체를 공유할 수 있다는 부작용**이 있다.

> 💡얕은 복사와 깊은 복사: 얕은 복사는 중첩된 객체의 참조 값만 복사한 것을 의미하고, 깊은 복사는 중첩된 객체까지 모두 복사해서 원시 값처럼 완전한 복사본을 만드는 것을 의미. 때문에 얕은 복사는 중첩된 객체를 원본의 메모리 주소를 공유한다는 차이가 있다.

자바스크립트에서는 결국 식별자가 기억하는 메모리 공간에 저장되어 있는 값을 복사해서 전달하게 된다. 식별자가 기억하는 메모리 공간, 즉 변수에 저장되어 있는 값이 원시 값이냐 참조 값이냐의 차이만 있기 때문에, 엄밀히 **자바스크립트에는 "참조에 의한 전달"은 없고 "값에 의한 전달"만이 존재한다.** (공유에 의한 전달이라는 표현을 사용하기도 한다.)
