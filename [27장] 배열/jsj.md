# 27장 배열

## 27.1 배열이란?

- 여러개의 값을 순차적으로 나열한 자료 구조
- 요소
    - 배열이 가지고 있는 값. 자바스크립트의 모든 값은 배열의 요소가 될 수 있다.
- 인덱스
    - 배열에서 자신의 위치를 나타내는 0 이상의 정수. 배열의 요소에 접근할 때 사용함
- length 프로퍼티
    - 요소의 개수, 배열의 길이를 나타냄
    - 배열은 index와 length 프로퍼티를 갖기 때문에 요소에 접근이 가능하다
- 자바스크립트에서 배열이란 타입은 없으며 배열은 객체 타입니다.
- 배열 리터럴, Array 생성자 함수, Array.of, Array.from 메서드로 생성할 수 있다.
- 배열은 객체지만 일반 객체와는 구별된다.
    
    
    | 구분 | 객체 | 배열 |
    | --- | --- | --- |
    | 구조 | 프로퍼티 키와 프로퍼티 값 | 인덱스와 요소 |
    | 값의 참조 | 프로퍼티 키 | 인덱스 |
    | 값의 순서 | X | O |
    | length 프로퍼티 | X | O |

## 27.2 자바스크립트 배열은 배열이 아니다

- 밀집 배열
    - 동일한 크기의 메모리 공간이 빈틈없이 연속적으로 나열되어 있음, 하나의 데이터 타입으로 통일됨
- 자바 스크립트의 배열의 경우 일반적인 의미의 배열과는 달리 배열의 요소를 위한 각각의 메모리 공간은 동일한 크기를 갖거나 연속적으로 이어지지 않아도 된다.
- 배열의 요소가 연속적으로 이어져 있지 않은 배열을 희소 배열이라 한다.
- **자바 스크립트의 배열은 일반적인 배열의 동작을 흉내낸 특수한 객체다**
- 자바 스크립트 객체를 뜯어보면
    
    ```jsx
    console.log(Object.getOwnPropertyDescriptors([1,2,3]));
    /*
    {
    	'0': {value : 1, writable: true, enumerable : true, configurable: true}
    	...
    	length : {value: 3, writable: true, enumerable: false, configurable: false}
    }
    */
    ```
    
    이처럼 자바 스크립트 배열은 인덱스를 나타내는 문자열을 프로퍼티 키로 가지며 length 프로퍼티를 갖는 특수한 객체다
    
- 일반적인 배열 vs 자바 스크립트 배열
    - 일반적인 배열은 인덱스로 요소에 빠르게 접근할 수 있지만 요소를 삽입, 삭제시는 효율적이지 않음
    - 자바스크립트 배열은 해시 테이블로 구현된 객체이므로 인덱스로 요소에 접근하는 경우 일반적인 배열보다 성능적인 면에서 느릴수 있지만, 요소를 삽입, 삭제시 일반적인 배열보다는 더 빠르다.

## 27.3 length 프로퍼티와 희소 배열

- **희소 배열은 length와 배열 요소의 개수가 일치하지 않는다.**
- **희소 배열의 length는 희소 배열의 실제 요소 개수보다 언제나 크다.**
- 자바 스크립트는 희소배열을 사용할 수는 있지만 최적화적인 측면에서 좋지 않다.
- **배열에는 같은 타입의 요소를 연속적으로 위치**시켜 희소배열을 생성하지 않도록 하자.

## 27.4 배열 생성

- 배열 리터럴
    
    ```jsx
    const arr = [1, 2, 3];
    ```
    
    - 배열 리터럴은 객체 리터럴과 달리 프로퍼티 키가 없고 값만 존재한다.
- Array 생성자 함수
    
    ```jsx
    const arr = new Array(10);
    ```
    
    - 전달된 인수가 1개이고 숫자인 경우 length 프로퍼티 값이 해당 인수인 배열을 생성
    - 이때 생성된 배열은 희소 배열로 length 프로퍼티 값이 0은 아니지만 실제로 배열의 요소는 존재하지 않는다.
    - Array 생성자 함수는 new 연산자와 함께 호출하지 않더라도 생성자 함수로 동작한다. 이는 Array 생성자 함수 내부에서 new.target을 확인하기 때문이다.
- Array.of
    
    ```jsx
    Array.of(1);
    ```
    
    - 전달된 인수를 요소로 갖는 배열을 생성
- Array.from
    
    ```jsx
    Array.from({length:2, 0:'a', 1:'b'}); //['a', 'b']
    
    Array.from({length:3}, (_, i) =>i); //[0,1,2]
    ```
    
    - 두번째 인수로 전달한 콜백함수를 통해 값을 만들면서 요소를 채울 수도 있다.

## 27.5 배열 요소의 참조

- 배열 요소를 참조할 때는 대괄호(`[]`)안에 인덱스를 넣어 표기한다.
- 존재하지 않는 요소에 접근하면 undefined가 반환된다.
(배열은 사실 인덱스를 나타내는 문자열을 프로퍼티 키로 갖는 객체이기 때문)

## 27.6 배열 요소의 추가와 갱신

- 객체처럼 배열에도 요소를 동적으로 추가할 수 있다.
- 존재하지 않는 인덱스를 이용해 값을 할당하면 새로운 요소가 추가되며 length 프로퍼티 값은 자동 갱신된다.
- 정수 이외의 값을 인덱스처럼 사용하면 요소가 생성되는 것이 아니라 프로퍼티가 생성된다. 이때 추가된 프로퍼티는 length 프로퍼티 값에 영향을 주지 않는다.

## 27.7 배열 요소의 삭제

- 배열은 객체이므로 delete 연산자를 통해 배열의 특정 요소를 삭제할 수 있다.

## 27.8 배열 메서드

- **배열에는 원본 배열(배열 메서드를 호출한 배열, this가 가리키는 배열)을 직접 변경하는 메서드와 원본 배열을 직접 변경하지 않고 새로운 배열을 생성하여 반환하는 메서드가 있다.**
- Array.isArray
    - 생성자 함수의 정적 메서드로, 전달된 인수가 배열인지 아닌지 판단하여 불리언 값을 반환
- Array.prototype.indexOf
    - 원본 배열에서 인수로 전달된 요소를 검색하여 인덱스를 반환한다.
    - 원본 배열에서 인수로 전달한 요소가 존재하지 않으면 -1을 반환한다.
- Array.prototype.push
    - 인수로 전달받은 값을 원본 배열의 마지막 요소로 추가한다.
    - push 대신 length 프로퍼티를 사용하여 배열의 마지막에 요소를 직접 추가할 수 있다.
    (이게 더 빠름)
    
    ```jsx
    arr[arr.length] = 3; 
    ```
    
- Array.prototype.pop
    - 원본 배열에서 마지막 요소를 제거하고 제거한 요소를 반환
- Array.prototype.unshift
    - 인수로 전달받은 값을 원본 배열의 선두에 요소로 추가
- Array.prototype.shift
    - 첫번째 요소를 제거하고 제거한 요소를 반환
- Array.prototype.concat
    - 인수로 전달된 값을 원본 배열의 마지막 요소로 추가한 새로운 배열을 반환
    - push, unshift와 다르게 원본 배열을 변경하지 않고 새로운 배열을 반환한다.
- Array.prototype.splice
    - 원본 배열의 중간에 있는 요소를 제거할 때 사용
    
    ```jsx
    const arr = [1, 2, 3, 4];
    
    const result = arr.splice(1, 2, 20, 30);
    //arr의 인덱스 1부터 2개의 요소를 제거하고 그 자리에 20, 30을 삽입
    ```
    
    - 3번째 인수(추가할 요소들의 목록)을 전달하지 않으면 원본 배열에서 해당되는 요소들을 제거하기만 한다.
- Array.prototype.slice
    - 인수로 전달된 범위의 요소들을 복사하여 배열로 반환한다.
    
    ```jsx
    const arr = [1, 2, 3];
    
    arr.slice(0, 1); //[1]
    ```
    
    - 2번째 인수를 생략하면 첫번째 인수가 되는 인덱스 부터 모든 요소를 복사하여 배열로 반환
    - 첫번째 인수가 음수면 배열의 끝부터 요소를 복사하여 배열로 반환한다.
        
        ```jsx
        const arr = [1, 2, 3];
        
        arr.slice(-1); //[3]
        
        arr.slice(-2); //[2, 3]
        ```
        
- Array.prototype.join
    - 원본 배열의 모든 요소를 문자열로 변환한 후 구분자(기본은 콤마)로 연결한 문자열을 반환
    
    ```jsx
    const arr = [1, 2, 3, 4];
    
    arr.join(); //'1,2,3,4';
    arr.join(''); //'1234';
    ```
    
- Array.prototype.reverse
    - 원본 배열의 순서를 반대로 뒤집어서 반환
- Array.prototype.fill
    - 전달받은 값을 배열의 처음부터 끝까지 요소로 채움
- Array.prototype.includes
    - 배열 내에 특정 요소가 포함되어 있는지 확인
- Array.prototype.flat
    - 인수로 전달한 길이만큼 재귀적으로 배열을 평탄화
    
    ```jsx
    [1, [2,3,4,5]].flat() //[1,2,3,4,5]
    [1,[2,[3,[4]]]].flat(1) //[1,2,[3,[4]]]
    ```
    

## 27.9 배열 고차 함수

- Array.prototype.sort
    - 원본 배열의 요소를 정렬하여 반환
    - 기본은 오름차순이다. 내림차순의 경우 sort이후 reverse 메서드로 뒤집자
    - 하지만 요소를 정렬할 때 문자열로 변환한 후 유니코드 코드 포인트의 순서를 기준으로 정렬하기에 이런 경우가 생길 수 있다.
        
        ```jsx
        [2, 10].sort() //[10, 2]
        ```
        
    - 따라서 숫자 요소를 정렬할 때는 정렬 순서를 정의하는 비교 함수를 인수로 전달해야 한다.
- Array.prototype.forEach
    - for문을 대체할 수 있는 고차함수
    - 순회의 중단은 불가능하다. 반복문을 메서드 내부로 은닉하였기 때문이다.
- Array.prototype.map
    - 배열의 모든 요소들을 순회하며 인수로 전달받은 콜백 함수를 반복 호출하여 해당 **콜백 함수의 반환값들로 구성된 새로운 배열을 반환한다.**
    - **map 메서드가 생성하여 반환하는 새로운 배열의 length는 원본 배열의 length 값과 반드시 일치한다. 서로 1:1 매핑한다.**
- Array.prototype.filter
    - 배열의 모든 요소들을 순회하며 인수로 전달받은 콜백 함수를 반복 호출하여 해당 **콜백 함수의 반환값이 true인 요소로만 구성된 새로운 배열을 반환**
    - **filter메서드가 생성하여 반환하는 새로운 배열의 length는 원본 배열의 length 값보다 작거나 같다.**
    - 특정 요소를 제거할 경우, 해당 요소가 중복되어 있다면 중복된 요소를 모두 제거하므로 indexOf 메서드로 인덱스를 알아내자
- Array.prototype.reduce
    - 배열의 모든 요소들을 순회하며 인수로 전달받은 콜백 함수를 반복 호출하고 해당 반환값들을 다음 콜백 함수의 첫번째 인수로 전달하면서 **하나의 결과값으로 만들어 반환한다.**
    - **reduce 메서드를 호출할 때는 언제나 초기값을 전달하는 것이 안전하다.**
- Array.prototype.some
    - 배열의 모든 요소들을 순회하며 인수로 전달받은 콜백 함수를 반복 호출하고 해당 반환값이 하나라도 참이면 true, 모두 거짓이면 false 반환
- Array.prototype.every
    - 자신을 호출한 배열의 요소를 순회하면서 인수로 전달된 콜백 함수를 호출한다. 해당 반환값이 모두 참이면 true, 하나라도 거짓이면 false 반환
- Array.prototype.find
    - 배열의 요소들을 순회하면서 콜백 함수를 호출할 때 반환값이 true인 첫번째 요소를 반환
    - 하나도 없으면 undefined를 반환한다.
- Array.prototype.findindex
    - 반환값이 true인 첫번째 요소의 인덱스를 반환
- Array.prototype.flatMap
    - map 메서드를 통해 생성된 새로운 배열을 평탄화